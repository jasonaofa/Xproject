# 美术资源管理工具

这是一个用于管理Unity美术资源从SVN到Git仓库传输的工具，具有依赖检查和GUID冲突检测功能。

## 功能特性

### 核心功能
1. **依赖缺失检查**
   - 检查上传的美术资源是否存在依赖闭环
   - 如果闭环不完整，检查Git仓库目标分支是否已有缺失的依赖文件
   - 如果依赖在上传列表和Git仓库都找不到，则报错禁止上传

2. **GUID冲突检查**
   - 检查上传资源的.meta文件中的GUID
   - 检查这些GUID是否与Git仓库目标分支指定目录下已有资源的GUID冲突
   - 如果有冲突，提示用户并禁止上传

### 界面功能
- 路径配置：SVN仓库路径、Git仓库路径、编辑器路径
- 分支管理：统一的可搜索分支选择器，支持查看、搜索和切换分支
- 资源类型过滤：支持Prefab、Material、Texture、Animation、Script等
- 文件选择：支持单文件选择和文件夹批量选择，支持拖拽操作
- GUID查询：在SVN仓库中根据GUID查找对应资源
- 实时日志：显示操作过程和检查结果

## 安装和运行

### 环境要求
- Python 3.7+
- Git命令行工具
- SVN命令行工具（可选）

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python art_resource_manager.py
```

## 使用说明

### 基本使用流程
1. **配置路径**
   - 设置SVN仓库路径（美术资源所在目录）
   - 设置Git仓库路径（目标Git仓库）
   - 设置编辑器路径（Unity编辑器路径）

2. **选择要上传的文件**
   - 点击"选择文件"选择单个文件
   - 点击"选择文件夹"批量选择文件夹内的资源
   - 支持的文件类型：.prefab、.mat、.anim、.controller、.asset、.unity

3. **执行检查**
   - 点击"检查并推送"按钮
   - 程序会自动进行依赖检查和GUID冲突检查
   - 检查结果会显示在"检查结果"标签页中

4. **查看结果**
   - 如果检查通过，会显示"所有检查通过，可以上传！"
   - 如果检查失败，会详细显示失败原因（依赖缺失或GUID冲突）

### 高级功能
- **分支管理**：统一的分支管理界面，支持智能搜索分支名称和安全的分支切换操作
- **GUID查询**：输入GUID在SVN仓库中查找对应的资源文件
- **资源类型过滤**：可以按资源类型进行过滤操作
- **拖拽上传**：支持直接拖拽文件和文件夹到文件列表区域

## 技术实现

### 依赖分析
程序会解析Unity资源文件（通常是YAML格式），提取其中的依赖引用：
- GUID引用：`guid: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`
- 路径引用：`path: Assets/xxx/xxx.xxx`

### GUID检查
程序会读取所有.meta文件，提取其中的GUID：
```yaml
guid: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### 支持的资源类型
- .prefab：预制体文件
- .mat：材质文件
- .anim：动画文件
- .controller：动画控制器
- .asset：资源文件
- .unity：场景文件

## 注意事项

1. **文件格式**：确保Unity资源文件格式正确，程序需要解析YAML格式的资源文件
2. **权限**：确保程序对SVN和Git目录有读取权限
3. **Git仓库**：确保Git仓库路径正确，且是一个有效的Git仓库
4. **依赖关系**：程序会尽力解析依赖关系，但复杂的依赖可能需要手动检查

## 故障排除

### 常见问题
1. **"无法获取Git分支"**
   - 检查Git仓库路径是否正确
   - 确保Git命令行工具已安装并在PATH中

2. **"解析资源文件失败"**
   - 检查资源文件是否损坏
   - 确保文件是Unity生成的标准格式

3. **"依赖检查失败"**
   - 检查上传的文件列表是否完整
   - 确认Git仓库中是否已有相关依赖文件

### 日志查看
程序会在"操作日志"标签页中显示详细的操作过程，可以通过查看日志来诊断问题。

## 开发说明

### 代码结构
- `ResourceDependencyAnalyzer`：资源依赖分析器
- `GitSvnManager`：Git和SVN操作管理器
- `ResourceChecker`：资源检查线程（后台执行）
- `ArtResourceManager`：主界面类

### 扩展功能
可以根据需要扩展以下功能：
- 支持更多资源类型
- 添加自动修复功能
- 集成更多版本控制系统
- 添加配置文件保存功能 